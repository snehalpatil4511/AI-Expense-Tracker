<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinAIlytics Pro - AI-Powered Financial Intelligence</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/regression@2.0.1/dist/regression.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
    <style>
        :root {
            --primary: #2563EB;
            --primary-light: #93C5FD;
            --secondary: #10B981;
            --accent: #EF4444;
            --background: #F8FAFC;
            --card-bg: rgba(255, 255, 255, 0.8);
            --text: #1E293B;
            --text-light: #64748B;
            --border: #E2E8F0;
            --shadow: rgba(0, 0, 0, 0.05);
            --gradient-start: #2563EB;
            --gradient-end: #10B981;
        }

        .dark-mode {
            --primary: #3B82F6;
            --primary-light: #1E40AF;
            --secondary: #059669;
            --accent: #DC2626;
            --background: #0F172A;
            --card-bg: rgba(30, 41, 59, 0.6);
            --text: #F1F5F9;
            --text-light: #94A3B8;
            --border: #334155;
            --shadow: rgba(0, 0, 0, 0.2);
            --gradient-start: #3B82F6;
            --gradient-end: #059669;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
            background-image: 
                radial-gradient(at 80% 20%, rgba(var(--primary-light), 0.2) 0, transparent 60%),
                radial-gradient(at 20% 80%, rgba(var(--secondary), 0.2) 0, transparent 60%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 16px;
            background: var(--card-bg);
            box-shadow: 0 8px 16px var(--shadow);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo i {
            font-size: 28px;
        }

        .theme-toggle {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text);
            box-shadow: 0 4px 6px var(--shadow);
            backdrop-filter: blur(10px);
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 16px var(--shadow);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .stat-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
        }

        .stat-card i {
            font-size: 32px;
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 50%;
        }

        .balance i {
            background-color: var(--primary-light);
            color: var(--primary);
        }

        .income i {
            background-color: rgba(16, 185, 129, 0.2);
            color: var(--secondary);
        }

        .expense i {
            background-color: rgba(239, 68, 68, 0.2);
            color: var(--accent);
        }

        .stat-card h3 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-light);
            margin-bottom: 8px;
        }

        .stat-card .amount {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 5px;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-card .change {
            font-size: 14px;
            font-weight: 500;
        }

        .positive {
            color: var(--secondary);
        }

        .negative {
            color: var(--accent);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
        }

        .section-title i {
            color: var(--primary);
        }

        .transaction-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-light);
        }

        .form-group input, .form-group select {
            padding: 14px 16px;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: var(--card-bg);
            color: var(--text);
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
        }

        .voice-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .voice-input button {
            padding: 14px;
            border-radius: 12px;
            border: none;
            background: var(--primary);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .voice-input button:hover {
            background: var(--primary-light);
            transform: scale(1.05);
        }

        .voice-input button.listening {
            background: var(--accent);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .btn-primary {
            padding: 14px 16px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            color: white;
            font-weight: 600;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .transactions-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s;
        }

        .transaction-item:hover {
            background: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
            padding-left: 10px;
            padding-right: 10px;
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .transaction-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .transaction-details {
            display: flex;
            flex-direction: column;
        }

        .transaction-details .description {
            font-weight: 600;
            font-size: 16px;
        }

        .transaction-details .category {
            font-size: 14px;
            color: var(--text-light);
        }

        .transaction-amount {
            font-weight: 700;
            font-size: 16px;
        }

        .income-amount {
            color: var(--secondary);
        }

        .expense-amount {
            color: var(--accent);
        }

        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
        }

        .chart-container {
            position: relative;
            height: 320px;
        }

        .ai-insights {
            margin-bottom: 30px;
        }

        .insights-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .insights-container {
                grid-template-columns: 1fr;
            }
        }

        .insight-card {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 20px;
            border-radius: 12px;
            background: var(--card-bg);
            box-shadow: 0 4px 8px var(--shadow);
            transition: all 0.3s;
        }

        .insight-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px var(--shadow);
        }

        .insight-icon {
            padding: 12px;
            border-radius: 12px;
            background: var(--primary-light);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .insight-content h4 {
            margin-bottom: 8px;
            font-size: 16px;
        }

        .insight-content p {
            color: var(--text-light);
            font-size: 14px;
            line-height: 1.5;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
            font-size: 14px;
            border-top: 1px solid var(--border);
            margin-top: 30px;
        }

        .ai-suggestion {
            background-color: rgba(37, 99, 235, 0.1);
            border-left: 4px solid var(--primary);
            padding: 12px 16px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ai-suggestion i {
            color: var(--primary);
        }

        .ai-prediction {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(37, 99, 235, 0.15));
            border-left: 4px solid var(--secondary);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .ai-prediction h4 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: var(--secondary);
        }

        .prediction-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .prediction-text {
            font-size: 14px;
            color: var(--text-light);
        }

        .prediction-amount {
            font-weight: 700;
            font-size: 20px;
            color: var(--secondary);
        }

        .income-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .income-charts {
                grid-template-columns: 1fr;
            }
        }

        .api-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            font-size: 14px;
            color: var(--text-light);
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-connected {
            background-color: var(--secondary);
        }

        .status-disconnected {
            background-color: var(--accent);
        }

        .feature-highlights {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 968px) {
            .feature-highlights {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 580px) {
            .feature-highlights {
                grid-template-columns: 1fr;
            }
        }

        .feature-card {
            padding: 20px;
            border-radius: 12px;
            background: var(--card-bg);
            box-shadow: 0 4px 8px var(--shadow);
            text-align: center;
            transition: all 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px var(--shadow);
        }

        .feature-icon {
            font-size: 36px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .feature-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .feature-desc {
            font-size: 14px;
            color: var(--text-light);
        }

        .tab-container {
            margin-bottom: 30px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 20px;
            border-radius: 8px;
            background: var(--card-bg);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .receipt-upload {
            border: 2px dashed var(--border);
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            margin-top: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .receipt-upload:hover {
            border-color: var(--primary);
            background: rgba(37, 99, 235, 0.05);
        }

        .receipt-upload i {
            font-size: 42px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .financial-goal {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-radius: 12px;
            background: var(--card-bg);
            margin-bottom: 15px;
            box-shadow: 0 4px 8px var(--shadow);
        }

        .goal-progress {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .goal-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            border-radius: 4px;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted var(--text-light);
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--text);
            color: var(--background);
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .loading-bar {
            height: 4px;
            width: 100%;
            background: var(--border);
            border-radius: 2px;
            overflow: hidden;
            margin: 10px 0;
        }

        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            border-radius: 2px;
            width: 0%;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-brain"></i>
                <span>FinAIlytics Pro</span>
            </div>
            <button class="theme-toggle" id="themeToggle">
                <i class="fas fa-moon"></i>
                <span>Dark Mode</span>
            </button>
        </header>

        <div class="feature-highlights">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="feature-title">AI-Powered Insights</div>
                <div class="feature-desc">Get intelligent financial recommendations and predictions</div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-receipt"></i>
                </div>
                <div class="feature-title">Receipt Scanning</div>
                <div class="feature-desc">Upload receipts for automatic expense tracking</div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="feature-title">Advanced Analytics</div>
                <div class="feature-desc">Deep insights into your financial patterns</div>
            </div>
        </div>

        <div class="dashboard">
            <div class="card stat-card balance">
                <i class="fas fa-wallet"></i>
                <h3>TOTAL BALANCE</h3>
                <div class="amount" id="totalBalance">$0.00</div>
                <div class="change" id="balanceChange">+0% from last month</div>
            </div>
            <div class="card stat-card income">
                <i class="fas fa-money-bill-wave"></i>
                <h3>TOTAL INCOME</h3>
                <div class="amount" id="totalIncome">$0.00</div>
                <div class="change" id="incomeChange">+0% from last month</div>
            </div>
            <div class="card stat-card expense">
                <i class="fas fa-shopping-bag"></i>
                <h3>TOTAL EXPENSE</h3>
                <div class="amount" id="totalExpense">$0.00</div>
                <div class="change" id="expenseChange">+0% from last month</div>
            </div>
        </div>

        <div class="main-content">
            <div class="card">
                <h2 class="section-title"><i class="fas fa-plus-circle"></i> Add New Transaction</h2>
                <form class="transaction-form" id="transactionForm">
                    <div class="form-group">
                        <label for="description">Description</label>
                        <div class="voice-input">
                            <input type="text" id="description" placeholder="Enter description" required>
                            <button type="button" id="voiceBtn"><i class="fas fa-microphone"></i></button>
                        </div>
                        <div class="ai-suggestion" id="aiSuggestion">
                            <i class="fas fa-robot"></i>
                            <span>AI will suggest a category as you type</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="amount">Amount</label>
                        <input type="number" id="amount" placeholder="Enter amount" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="type">Type</label>
                        <select id="type" required>
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="category">Category</label>
                        <select id="category" required>
                            <option value="">Select a category</option>
                            <option value="Salary">Salary</option>
                            <option value="Freelance">Freelance</option>
                            <option value="Investment">Investment</option>
                            <option value="Gifts">Gifts</option>
                            <option value="Food">Food & Dining</option>
                            <option value="Shopping">Shopping</option>
                            <option value="Transport">Transportation</option>
                            <option value="Entertainment">Entertainment</option>
                            <option value="Utilities">Utilities</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="date">Date</label>
                        <input type="date" id="date" required>
                    </div>
                    <button type="submit" class="btn-primary">Add Transaction</button>
                </form>

                <div class="receipt-upload" id="receiptUpload">
                    <i class="fas fa-receipt"></i>
                    <h3>Upload Receipt</h3>
                    <p>Click or drag & drop to scan receipt</p>
                    <input type="file" id="receiptInput" accept="image/*" style="display: none;">
                </div>

                <div class="ai-prediction">
                    <h4><i class="fas fa-lightbulb"></i> AI Spending Prediction</h4>
                    <div class="prediction-content">
                        <div class="prediction-text">Based on your spending habits, you're likely to spend this month:</div>
                        <div class="prediction-amount" id="predictionAmount">$0.00</div>
                    </div>
                </div>

                <div class="api-status">
                    <span class="status-indicator status-connected" id="apiStatus"></span>
                    <span id="apiStatusText">AI API: Connected - Real-time analysis enabled</span>
                </div>
            </div>

            <div class="card">
                <h2 class="section-title"><i class="fas fa-history"></i> Recent Transactions</h2>
                <div class="tabs">
                    <div class="tab active" data-tab="all">All</div>
                    <div class="tab" data-tab="income">Income</div>
                    <div class="tab" data-tab="expenses">Expenses</div>
                </div>
                <div class="transactions-list" id="transactionsList">
                    <!-- Transactions will be added here dynamically -->
                </div>
            </div>
        </div>

        <div class="tab-container">
            <div class="tabs">
                <div class="tab active" data-tab="charts">Financial Charts</div>
                <div class="tab" data-tab="goals">Financial Goals</div>
                <div class="tab" data-tab="trends">Spending Trends</div>
            </div>

            <div class="tab-content active" id="charts-tab">
                <div class="charts-container">
                    <div class="card">
                        <h2 class="section-title"><i class="fas fa-chart-pie"></i> Expenses by Category</h2>
                        <div class="chart-container">
                            <canvas id="expenseChart"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <h2 class="section-title"><i class="fas fa-chart-line"></i> Monthly Summary</h2>
                        <div class="chart-container">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="income-charts">
                    <div class="card">
                        <h2 class="section-title"><i class="fas fa-money-bill-wave"></i> Income by Category</h2>
                        <div class="chart-container">
                            <canvas id="incomeChart"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <h2 class="section-title"><i class="fas fa-piggy-bank"></i> Savings Progress</h2>
                        <div class="chart-container">
                            <canvas id="savingsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="goals-tab">
                <div class="card">
                    <h2 class="section-title"><i class="fas fa-bullseye"></i> Financial Goals</h2>
                    <div class="form-group">
                        <label for="goalName">Goal Name</label>
                        <input type="text" id="goalName" placeholder="e.g., New Laptop">
                    </div>
                    <div class="form-group">
                        <label for="goalAmount">Target Amount</label>
                        <input type="number" id="goalAmount" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label for="goalDeadline">Target Date</label>
                        <input type="date" id="goalDeadline">
                    </div>
                    <button class="btn-primary" id="addGoalBtn">Add Goal</button>

                    <div id="goalsContainer">
                        <!-- Goals will be added here dynamically -->
                    </div>
                </div>
            </div>

            <div class="tab-content" id="trends-tab">
                <div class="card">
                    <h2 class="section-title"><i class="fas fa-chart-bar"></i> Spending Trends</h2>
                    <div class="chart-container">
                        <canvas id="trendsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="card ai-insights">
            <h2 class="section-title"><i class="fas fa-robot"></i> AI-Powered Insights</h2>
            <div class="insights-container" id="insightsContainer">
                <!-- AI Insights will be added here dynamically -->
            </div>
        </div>

        <footer>
            <p>© 2023 FinAIlytics Pro - AI-Powered Financial Intelligence | Built for Mega Hackathon</p>
        </footer>
    </div>

    <script>
        // Enhanced transactions with more demo data
        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        
        // If no transactions in localStorage, initialize with demo data
        if (transactions.length === 0) {
            transactions = [
                { id: 1, description: "Salary", amount: 3500, type: "income", category: "Salary", date: "2023-09-01" },
                { id: 2, description: "Freelance Work", amount: 1200, type: "income", category: "Freelance", date: "2023-09-05" },
                { id: 3, description: "Stock Dividends", amount: 250, type: "income", category: "Investment", date: "2023-09-10" },
                { id: 4, description: "Birthday Gift", amount: 100, type: "income", category: "Gifts", date: "2023-09-15" },
                { id: 5, description: "Starbucks Coffee", amount: 5.50, type: "expense", category: "Food", date: "2023-09-07" },
                { id: 6, description: "Amazon Purchase", amount: 89.99, type: "expense", category: "Shopping", date: "2023-09-10" },
                { id: 7, description: "Netflix Subscription", amount: 15.99, type: "expense", category: "Entertainment", date: "2023-09-15" },
                { id: 8, description: "Gas Station", amount: 45.00, type: "expense", category: "Transport", date: "2023-09-18" },
                { id: 9, description: "Grocery Shopping", amount: 125.30, type: "expense", category: "Food", date: "2023-09-20" },
                { id: 10, description: "Electricity Bill", amount: 78.45, type: "expense", category: "Utilities", date: "2023-09-22" }
            ];
            localStorage.setItem('transactions', JSON.stringify(transactions));
        }

        // Initialize financial goals
        let financialGoals = JSON.parse(localStorage.getItem('financialGoals')) || [];

        // DOM Elements
        const themeToggle = document.getElementById('themeToggle');
        const transactionForm = document.getElementById('transactionForm');
        const transactionsList = document.getElementById('transactionsList');
        const voiceBtn = document.getElementById('voiceBtn');
        const descriptionInput = document.getElementById('description');
        const categorySelect = document.getElementById('category');
        const aiSuggestion = document.getElementById('aiSuggestion');
        const insightsContainer = document.getElementById('insightsContainer');
        const totalBalance = document.getElementById('totalBalance');
        const totalIncome = document.getElementById('totalIncome');
        const totalExpense = document.getElementById('totalExpense');
        const balanceChange = document.getElementById('balanceChange');
        const incomeChange = document.getElementById('incomeChange');
        const expenseChange = document.getElementById('expenseChange');
        const predictionAmount = document.getElementById('predictionAmount');
        const apiStatus = document.getElementById('apiStatus');
        const apiStatusText = document.getElementById('apiStatusText');
        const receiptUpload = document.getElementById('receiptUpload');
        const receiptInput = document.getElementById('receiptInput');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const goalsContainer = document.getElementById('goalsContainer');
        const addGoalBtn = document.getElementById('addGoalBtn');

        // Chart instances
        let expenseChart, monthlyChart, incomeChart, savingsChart, trendsChart;

        // Simulate API connection
        function checkApiConnection() {
            // Simulate API check with 90% success rate for demo
            const isConnected = Math.random() > 0.1;
            
            if (isConnected) {
                apiStatus.className = 'status-indicator status-connected';
                apiStatusText.textContent = 'AI API: Connected - Real-time analysis enabled';
                return true;
            } else {
                apiStatus.className = 'status-indicator status-disconnected';
                apiStatusText.textContent = 'AI API: Disconnected - Using local analysis';
                return false;
            }
        }

        // Theme Toggle
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            if (document.body.classList.contains('dark-mode')) {
                themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>Light Mode</span>';
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i><span>Dark Mode</span>';
            }
            
            // Update charts for theme change
            updateCharts();
        });

        // Tab functionality
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                // Update active tab
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Show active content
                tabContents.forEach(content => {
                    content.classList.remove('active');
                    if (content.id === `${tabId}-tab`) {
                        content.classList.add('active');
                    }
                });

                // If trends tab is selected, update trends chart
                if (tabId === 'trends') {
                    updateTrendsChart();
                }
            });
        });

        // Voice Input
        voiceBtn.addEventListener('click', () => {
            voiceBtn.classList.add('listening');
            aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>Listening... Speak now</span>';
            
            // Simulate voice input for demo purposes
            setTimeout(() => {
                voiceBtn.classList.remove('listening');
                descriptionInput.value = "Lunch at Italian restaurant";
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI suggests category: Food & Dining</span>';
                categorySelect.value = "Food";
            }, 2000);
        });

        // AI Category Prediction Simulation
        descriptionInput.addEventListener('input', () => {
            const text = descriptionInput.value.toLowerCase();
            
            if (text.includes("netflix") || text.includes("spotify") || text.includes("hulu")) {
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI suggests category: Entertainment</span>';
                categorySelect.value = "Entertainment";
            } else if (text.includes("lunch") || text.includes("dinner") || text.includes("restaurant") || text.includes("coffee")) {
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI suggests category: Food & Dining</span>';
                categorySelect.value = "Food";
            } else if (text.includes("gas") || text.includes("fuel") || text.includes("uber") || text.includes("taxi")) {
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI suggests category: Transportation</span>';
                categorySelect.value = "Transport";
            } else if (text.includes("amazon") || text.includes("shopping") || text.includes("mall")) {
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI suggests category: Shopping</span>';
                categorySelect.value = "Shopping";
            } else if (text.includes("salary") || text.includes("paycheck")) {
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI suggests category: Salary</span>';
                categorySelect.value = "Salary";
                document.getElementById('type').value = "income";
            } else if (text.includes("freelance") || text.includes("contract")) {
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI suggests category: Freelance</span>';
                categorySelect.value = "Freelance";
                document.getElementById('type').value = "income";
            } else if (text.length > 3) {
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>Analyzing description...</span>';
            } else {
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI will suggest a category as you type</span>';
            }
        });

        // Receipt Upload
        receiptUpload.addEventListener('click', () => {
            receiptInput.click();
        });

        receiptInput.addEventListener('change', (e) => {
            if (e.target.files && e.target.files[0]) {
                const file = e.target.files[0];
                
                // Simulate AI receipt processing
                aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI is processing receipt...</span>';
                
                setTimeout(() => {
                    // Simulate extracted data from receipt
                    const randomAmount = (Math.random() * 50 + 5).toFixed(2);
                    const randomCategory = ["Food", "Shopping", "Transport", "Utilities"][Math.floor(Math.random() * 4)];
                    
                    document.getElementById('amount').value = randomAmount;
                    document.getElementById('category').value = randomCategory;
                    document.getElementById('type').value = "expense";
                    document.getElementById('description').value = "Receipt scan: " + randomCategory + " purchase";
                    
                    aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI extracted: $' + randomAmount + ' for ' + randomCategory + '</span>';
                    
                    // Simulate animation
                    anime({
                        targets: '#receiptUpload',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        duration: 1000,
                        complete: function() {
                            setTimeout(() => {
                                anime({
                                    targets: '#receiptUpload',
                                    backgroundColor: '',
                                    duration: 1000
                                });
                            }, 1000);
                        }
                    });
                }, 2000);
            }
        });

        // Add Transaction
        transactionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const description = document.getElementById('description').value;
            const amount = parseFloat(document.getElementById('amount').value);
            const type = document.getElementById('type').value;
            const category = document.getElementById('category').value;
            const date = document.getElementById('date').value || new Date().toISOString().split('T')[0];
            
            const newTransaction = {
                id: transactions.length > 0 ? Math.max(...transactions.map(t => t.id)) + 1 : 1,
                description,
                amount,
                type,
                category,
                date
            };
            
            transactions.unshift(newTransaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));
            
            updateUI();
            
            transactionForm.reset();
            aiSuggestion.innerHTML = '<i class="fas fa-robot"></i><span>AI will suggest a category as you type</span>';
            
            // Show success animation
            anime({
                targets: '.btn-primary',
                backgroundColor: ['#10B981', '#2563EB'],
                duration: 1000
            });
        });

        // Add Financial Goal
        addGoalBtn.addEventListener('click', () => {
            const goalName = document.getElementById('goalName').value;
            const goalAmount = parseFloat(document.getElementById('goalAmount').value);
            const goalDeadline = document.getElementById('goalDeadline').value;
            
            if (!goalName || !goalAmount || !goalDeadline) {
                alert('Please fill all goal fields');
                return;
            }
            
            const newGoal = {
                id: financialGoals.length + 1,
                name: goalName,
                targetAmount: goalAmount,
                currentAmount: 0,
                deadline: goalDeadline,
                achieved: false
            };
            
            financialGoals.push(newGoal);
            localStorage.setItem('financialGoals', JSON.stringify(financialGoals));
            
            renderGoals();
            
            // Clear form
            document.getElementById('goalName').value = '';
            document.getElementById('goalAmount').value = '';
            document.getElementById('goalDeadline').value = '';
        });

        // Render Goals
        function renderGoals() {
            goalsContainer.innerHTML = '';
            
            financialGoals.forEach(goal => {
                const progress = (goal.currentAmount / goal.targetAmount) * 100;
                const goalEl = document.createElement('div');
                goalEl.className = 'financial-goal';
                
                goalEl.innerHTML = `
                    <div>
                        <h3>${goal.name}</h3>
                        <p>$${goal.currentAmount.toFixed(2)} of $${goal.targetAmount.toFixed(2)}</p>
                        <div class="goal-progress">
                            <div class="goal-progress-bar" style="width: ${progress}%"></div>
                        </div>
                        <p>Target: ${new Date(goal.deadline).toLocaleDateString()}</p>
                    </div>
                    <div>
                        <button class="btn-primary" onclick="addToGoal(${goal.id}, 10)">+$10</button>
                    </div>
                `;
                
                goalsContainer.appendChild(goalEl);
            });
        }

        // Add to Goal (global function for inline onclick)
        window.addToGoal = function(goalId, amount) {
            const goal = financialGoals.find(g => g.id === goalId);
            if (goal) {
                goal.currentAmount += amount;
                if (goal.currentAmount > goal.targetAmount) {
                    goal.currentAmount = goal.targetAmount;
                    goal.achieved = true;
                    
                    // Celebrate achieved goal
                    anime({
                        targets: '.financial-goal',
                        scale: [1, 1.05, 1],
                        duration: 1000,
                        easing: 'easeInOutQuad'
                    });
                }
                
                localStorage.setItem('financialGoals', JSON.stringify(financialGoals));
                renderGoals();
            }
        };

        // Render Transactions with filtering
        function renderTransactions(filter = 'all') {
            transactionsList.innerHTML = '';
            
            let filteredTransactions = transactions;
            if (filter === 'income') {
                filteredTransactions = transactions.filter(t => t.type === 'income');
            } else if (filter === 'expenses') {
                filteredTransactions = transactions.filter(t => t.type === 'expense');
            }
            
            // Show only the most recent 8 transactions for UI simplicity
            const recentTransactions = filteredTransactions.slice(0, 8);
            
            if (recentTransactions.length === 0) {
                transactionsList.innerHTML = '<p class="no-transactions">No transactions found</p>';
                return;
            }
            
            recentTransactions.forEach(transaction => {
                const transactionEl = document.createElement('div');
                transactionEl.className = 'transaction-item';
                
                const iconClass = transaction.type === 'income' ? 'fa-arrow-down' : 'fa-arrow-up';
                const iconColor = transaction.type === 'income' ? 'income-amount' : 'expense-amount';
                
                transactionEl.innerHTML = `
                    <div class="transaction-info">
                        <div class="transaction-icon" style="background-color: ${getCategoryColor(transaction.category, transaction.type)}">
                            <i class="fas ${iconClass}"></i>
                        </div>
                        <div class="transaction-details">
                            <div class="description">${transaction.description}</div>
                            <div class="category">${transaction.category} • ${formatDate(transaction.date)}</div>
                        </div>
                    </div>
                    <div class="transaction-amount ${iconColor}">
                        ${transaction.type === 'income' ? '+' : '-'}$${transaction.amount.toFixed(2)}
                    </div>
                `;
                
                transactionsList.appendChild(transactionEl);
            });
        }

        // Filter transactions when tabs are clicked
        document.querySelectorAll('.tab[data-tab]').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabType = tab.getAttribute('data-tab');
                if (['all', 'income', 'expenses'].includes(tabType)) {
                    renderTransactions(tabType);
                }
            });
        });

        // Format date for display
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        }

        // Get category color
        function getCategoryColor(category, type) {
            if (type === 'income') {
                const colors = {
                    'Salary': 'rgba(16, 185, 129, 0.3)',
                    'Freelance': 'rgba(16, 185, 129, 0.4)',
                    'Investment': 'rgba(16, 185, 129, 0.5)',
                    'Gifts': 'rgba(16, 185, 129, 0.6)',
                    'Other': 'rgba(16, 185, 129, 0.2)'
                };
                return colors[category] || 'rgba(16, 185, 129, 0.2)';
            } else {
                const colors = {
                    'Food': 'rgba(239, 68, 68, 0.2)',
                    'Shopping': 'rgba(239, 68, 68, 0.3)',
                    'Transport': 'rgba(239, 68, 68, 0.4)',
                    'Entertainment': 'rgba(239, 68, 68, 0.5)',
                    'Utilities': 'rgba(239, 68, 68, 0.6)',
                    'Other': 'rgba(156, 163, 175, 0.2)'
                };
                return colors[category] || 'rgba(156, 163, 175, 0.2)';
            }
        }

        // Calculate financial metrics
        function calculateMetrics() {
            let totalIncomeValue = 0;
            let totalExpenseValue = 0;
            
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            // Calculate totals for current month
            transactions.forEach(transaction => {
                const transactionDate = new Date(transaction.date);
                if (transactionDate.getMonth() === currentMonth && transactionDate.getFullYear() === currentYear) {
                    if (transaction.type === 'income') {
                        totalIncomeValue += transaction.amount;
                    } else {
                        totalExpenseValue += transaction.amount;
                    }
                }
            });
            
            // Calculate totals for previous month
            let prevMonthIncome = 0;
            let prevMonthExpense = 0;
            
            transactions.forEach(transaction => {
                const transactionDate = new Date(transaction.date);
                let prevMonth = currentMonth - 1;
                let year = currentYear;
                
                if (prevMonth < 0) {
                    prevMonth = 11;
                    year = currentYear - 1;
                }
                
                if (transactionDate.getMonth() === prevMonth && transactionDate.getFullYear() === year) {
                    if (transaction.type === 'income') {
                        prevMonthIncome += transaction.amount;
                    } else {
                        prevMonthExpense += transaction.amount;
                    }
                }
            });
            
            // Calculate percentage changes
            const incomeChangeValue = prevMonthIncome > 0 ? 
                ((totalIncomeValue - prevMonthIncome) / prevMonthIncome * 100).toFixed(1) : 0;
                
            const expenseChangeValue = prevMonthExpense > 0 ? 
                ((totalExpenseValue - prevMonthExpense) / prevMonthExpense * 100).toFixed(1) : 0;
            
            // Update DOM elements
            totalBalance.textContent = `$${(totalIncomeValue - totalExpenseValue).toFixed(2)}`;
            totalIncome.textContent = `$${totalIncomeValue.toFixed(2)}`;
            totalExpense.textContent = `$${totalExpenseValue.toFixed(2)}`;
            
            incomeChange.textContent = `${incomeChangeValue >= 0 ? '+' : ''}${incomeChangeValue}% from last month`;
            incomeChange.className = `change ${incomeChangeValue >= 0 ? 'positive' : 'negative'}`;
            
            expenseChange.textContent = `${expenseChangeValue >= 0 ? '+' : ''}${expenseChangeValue}% from last month`;
            expenseChange.className = `change ${expenseChangeValue >= 0 ? 'positive' : 'negative'}`;
            
            const balanceChangeValue = ((totalIncomeValue - totalExpenseValue) - (prevMonthIncome - prevMonthExpense)) / 
                                        Math.max(prevMonthIncome - prevMonthExpense, 1) * 100;
            
            balanceChange.textContent = `${balanceChangeValue >= 0 ? '+' : ''}${balanceChangeValue.toFixed(1)}% from last month`;
            balanceChange.className = `change ${balanceChangeValue >= 0 ? 'positive' : 'negative'}`;
            
            return {
                totalIncome: totalIncomeValue,
                totalExpense: totalExpenseValue,
                incomeChange: incomeChangeValue,
                expenseChange: expenseChangeValue
            };
        }

        // Update Charts
        function updateCharts() {
            // Prepare data for expense chart
            const expenseCategoryTotals = {};
            
            transactions.forEach(transaction => {
                if (transaction.type === 'expense') {
                    if (!expenseCategoryTotals[transaction.category]) {
                        expenseCategoryTotals[transaction.category] = 0;
                    }
                    expenseCategoryTotals[transaction.category] += transaction.amount;
                }
            });
            
            const expenseLabels = Object.keys(expenseCategoryTotals);
            const expenseData = Object.values(expenseCategoryTotals);
            
            // Update expense chart
            if (expenseChart) {
                expenseChart.data.labels = expenseLabels;
                expenseChart.data.datasets[0].data = expenseData;
                expenseChart.update();
            } else {
                initExpenseChart(expenseLabels, expenseData);
            }
            
            // Prepare data for income chart
            const incomeCategoryTotals = {};
            
            transactions.forEach(transaction => {
                if (transaction.type === 'income') {
                    if (!incomeCategoryTotals[transaction.category]) {
                        incomeCategoryTotals[transaction.category] = 0;
                    }
                    incomeCategoryTotals[transaction.category] += transaction.amount;
                }
            });
            
            const incomeLabels = Object.keys(incomeCategoryTotals);
            const incomeData = Object.values(incomeCategoryTotals);
            
            // Update income chart
            if (incomeChart) {
                incomeChart.data.labels = incomeLabels;
                incomeChart.data.datasets[0].data = incomeData;
                incomeChart.update();
            } else {
                initIncomeChart(incomeLabels, incomeData);
            }
            
            // Prepare data for monthly chart
            const monthlyData = {
                income: [0, 0, 0, 0, 0, 0], // Last 6 months
                expense: [0, 0, 0, 0, 0, 0]  // Last 6 months
            };
            
            const currentDate = new Date();
            const monthLabels = [];
            
            // Generate labels for last 6 months
            for (let i = 5; i >= 0; i--) {
                const date = new Date(currentDate.getFullYear(), currentDate.getMonth() - i, 1);
                monthLabels.push(date.toLocaleString('default', { month: 'short' }));
            }
            
            // Calculate income and expense for each month
            transactions.forEach(transaction => {
                const transactionDate = new Date(transaction.date);
                const monthDiff = (currentDate.getFullYear() - transactionDate.getFullYear()) * 12 + 
                                 (currentDate.getMonth() - transactionDate.getMonth());
                
                if (monthDiff >= 0 && monthDiff < 6) {
                    const index = 5 - monthDiff;
                    if (transaction.type === 'income') {
                        monthlyData.income[index] += transaction.amount;
                    } else {
                        monthlyData.expense[index] += transaction.amount;
                    }
                }
            });
            
            // Update monthly chart
            if (monthlyChart) {
                monthlyChart.data.labels = monthLabels;
                monthlyChart.data.datasets[0].data = monthlyData.income;
                monthlyChart.data.datasets[1].data = monthlyData.expense;
                monthlyChart.update();
            } else {
                initMonthlyChart(monthLabels, monthlyData);
            }
            
            // Update savings chart
            updateSavingsChart();
        }

        // Update Trends Chart
        function updateTrendsChart() {
            const ctx = document.getElementById('trendsChart').getContext('2d');
            
            // Prepare data for trends (last 30 days)
            const dailyData = {
                income: Array(30).fill(0),
                expense: Array(30).fill(0)
            };
            
            const today = new Date();
            const dates = [];
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(today.getDate() - i);
                dates.push(date.toLocaleDateString(undefined, { month: 'short', day: 'numeric' }));
                
                transactions.forEach(transaction => {
                    const transactionDate = new Date(transaction.date);
                    if (
                        transactionDate.getDate() === date.getDate() &&
                        transactionDate.getMonth() === date.getMonth() &&
                        transactionDate.getFullYear() === date.getFullYear()
                    ) {
                        if (transaction.type === 'income') {
                            dailyData.income[29 - i] += transaction.amount;
                        } else {
                            dailyData.expense[29 - i] += transaction.amount;
                        }
                    }
                });
            }
            
            if (trendsChart) {
                trendsChart.destroy();
            }
            
            trendsChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [
                        {
                            label: 'Daily Income',
                            data: dailyData.income,
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: 'Daily Expenses',
                            data: dailyData.expense,
                            borderColor: 'rgb(239, 68, 68)',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Daily Income vs Expenses (30 Days)'
                        }
                    }
                }
            });
        }

        // Initialize Expense Chart
        function initExpenseChart(labels, data) {
            const expenseCtx = document.getElementById('expenseChart').getContext('2d');
            
            expenseChart = new Chart(expenseCtx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.7)',
                            'rgba(234, 88, 12, 0.7)',
                            'rgba(217, 119, 6, 0.7)',
                            'rgba(202, 138, 4, 0.7)',
                            'rgba(101, 163, 13, 0.7)',
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(5, 150, 105, 0.7)',
                            'rgba(6, 95, 70, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: 'Expense Distribution'
                        }
                    }
                }
            });
        }

        // Initialize Income Chart
        function initIncomeChart(labels, data) {
            const incomeCtx = document.getElementById('incomeChart').getContext('2d');
            
            incomeChart = new Chart(incomeCtx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(5, 150, 105, 0.7)',
                            'rgba(6, 95, 70, 0.7)',
                            'rgba(101, 163, 13, 0.7)',
                            'rgba(202, 138, 4, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: 'Income Distribution'
                        }
                    }
                }
            });
        }

        // Initialize Monthly Chart
        function initMonthlyChart(labels, data) {
            const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
            
            monthlyChart = new Chart(monthlyCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Income',
                            data: data.income,
                            backgroundColor: 'rgba(16, 185, 129, 0.7)',
                        },
                        {
                            label: 'Expenses',
                            data: data.expense,
                            backgroundColor: 'rgba(239, 68, 68, 0.7)',
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        // Update Savings Chart
        function updateSavingsChart() {
            const savingsCtx = document.getElementById('savingsChart').getContext('2d');
            const metrics = calculateMetrics();
            
            const savingsGoal = 5000; // Example savings goal
            const currentSavings = metrics.totalIncome - metrics.totalExpense;
            const savingsPercentage = (currentSavings / savingsGoal) * 100;
            
            if (savingsChart) {
                savingsChart.destroy();
            }
            
            savingsChart = new Chart(savingsCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Saved', 'Remaining'],
                    datasets: [{
                        data: [currentSavings, Math.max(0, savingsGoal - currentSavings)],
                        backgroundColor: [
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(239, 68, 68, 0.1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: `Savings Progress: ${savingsPercentage.toFixed(1)}%`
                        }
                    }
                }
            });
        }

        // Generate AI Insights
        function generateInsights() {
            const metrics = calculateMetrics();
            
            // Calculate average monthly expense
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            let monthlyExpenses = [];
            for (let i = 0; i < 6; i++) {
                let month = currentMonth - i;
                let year = currentYear;
                
                if (month < 0) {
                    month += 12;
                    year -= 1;
                }
                
                let monthlyExpense = 0;
                transactions.forEach(transaction => {
                    const transactionDate = new Date(transaction.date);
                    if (transactionDate.getMonth() === month && 
                        transactionDate.getFullYear() === year &&
                        transaction.type === 'expense') {
                        monthlyExpense += transaction.amount;
                    }
                });
                
                monthlyExpenses.push(monthlyExpense);
            }
            
            const avgMonthlyExpense = monthlyExpenses.reduce((a, b) => a + b, 0) / monthlyExpenses.length;
            
            // Generate prediction for current month
            const currentMonthExpense = monthlyExpenses[0] || 0;
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const daysSoFar = currentDate.getDate();
            
            let predictedExpense;
            if (daysSoFar > 0) {
                predictedExpense = (currentMonthExpense / daysSoFar) * daysInMonth;
            } else {
                predictedExpense = avgMonthlyExpense;
            }
            
            predictionAmount.textContent = `$${predictedExpense.toFixed(2)}`;
            
            // Generate insights based on data
            const insights = [];
            
            if (metrics.totalExpense > metrics.totalIncome * 0.8) {
                insights.push({
                    icon: 'fas fa-exclamation-triangle',
                    title: 'High Spending Alert',
                    content: 'Your expenses are over 80% of your income. Consider reducing discretionary spending.'
                });
            } else {
                insights.push({
                    icon: 'fas fa-check-circle',
                    title: 'Good Financial Health',
                    content: 'Your spending is at a healthy level compared to your income. Keep it up!'
                });
            }
            
            if (metrics.incomeChange > 0) {
                insights.push({
                    icon: 'fas fa-chart-line',
                    title: 'Income Growth',
                    content: `Your income increased by ${metrics.incomeChange}% from last month. Excellent progress!`
                });
            }
            
            // Find largest expense category
            let largestExpenseCategory = '';
            let largestExpenseAmount = 0;
            
            // Find largest income category
            let largestIncomeCategory = '';
            let largestIncomeAmount = 0;
            
            transactions.forEach(transaction => {
                if (transaction.type === 'expense' && transaction.amount > largestExpenseAmount) {
                    largestExpenseAmount = transaction.amount;
                    largestExpenseCategory = transaction.category;
                }
                
                if (transaction.type === 'income' && transaction.amount > largestIncomeAmount) {
                    largestIncomeAmount = transaction.amount;
                    largestIncomeCategory = transaction.category;
                }
            });
            
            if (largestExpenseCategory) {
                insights.push({
                    icon: 'fas fa-tag',
                    title: 'Largest Expense',
                    content: `Your largest expense category is ${largestExpenseCategory}. Consider if this aligns with your priorities.`
                });
            }
            
            if (largestIncomeCategory) {
                insights.push({
                    icon: 'fas fa-money-bill-wave',
                    title: 'Primary Income Source',
                    content: `Your primary income source is ${largestIncomeCategory}. Consider diversifying your income streams.`
                });
            }
            
            // Savings potential insight
            const savingsPotential = metrics.totalIncome - metrics.totalExpense;
            if (savingsPotential > 0) {
                insights.push({
                    icon: 'fas fa-piggy-bank',
                    title: 'Savings Potential',
                    content: `You could save $${savingsPotential.toFixed(2)} this month. Consider setting up automatic transfers to savings.`
                });
            } else {
                insights.push({
                    icon: 'fas fa-exclamation-circle',
                    title: 'Budget Deficit',
                    content: `You're spending $${Math.abs(savingsPotential).toFixed(2)} more than you earn. Review your expenses.`
                });
            }
            
            // Render insights
            insightsContainer.innerHTML = '';
            
            insights.forEach(insight => {
                const insightEl = document.createElement('div');
                insightEl.className = 'insight-card';
                
                insightEl.innerHTML = `
                    <div class="insight-icon">
                        <i class="${insight.icon}"></i>
                    </div>
                    <div class="insight-content">
                        <h4>${insight.title}</h4>
                        <p>${insight.content}</p>
                    </div>
                `;
                
                insightsContainer.appendChild(insightEl);
            });
        }

        // Update the entire UI
        function updateUI() {
            renderTransactions();
            calculateMetrics();
            updateCharts();
            generateInsights();
            checkApiConnection();
            renderGoals();
        }

        // Initialize the app
        function initApp() {
            // Set today's date as default
            document.getElementById('date').valueAsDate = new Date();
            
            // Initialize the UI
            updateUI();
            
            // Simulate API connection
            checkApiConnection();
            
            // Add animation to dashboard cards
            anime({
                targets: '.stat-card',
                translateY: [20, 0],
                opacity: [0, 1],
                delay: anime.stagger(100),
                duration: 1000,
                easing: 'easeOutElastic(1, .8)'
            });
        }

        // Run the app
        initApp();
    </script>
</body>
</html>